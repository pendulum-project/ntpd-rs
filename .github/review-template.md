Checklist review:
 - [ ] Check for security implications from this change.
 - [ ] Documentation updated.
 - [ ] Changelog updated.
 - [ ] Adds relevant tests and fuzzers.
 - [ ] All changed lines are sufficiently covered by tests.
 - [ ] New dependencies are really needed.
